<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Full Body Tracker Pro</title>
<style>
body { background-color: #111; color: #f4e3b2; font-family: sans-serif; padding: 20px; }
h1 { color: #e1c699; }
button { margin: 5px; padding: 5px 10px; background-color: #443c28; color: #f4e3b2; border: none; border-radius: 4px; cursor: pointer; }
button:hover { background-color: #665c42; }
.exercise { margin-bottom: 10px; padding: 15px; border-radius: 8px; background-color: #1a1610; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; }
.progress-bar { height: 8px; border-radius: 4px; background-color: #555; width: 100%; margin-top: 5px; }
.progress { height: 8px; border-radius: 4px; background-color: #88b04b; width: 0%; transition: width 0.3s; }
.timer-circle { width: 50px; height: 50px; border-radius: 50%; border: 3px solid #b5a05b; display: flex; align-items: center; justify-content: center; font-size: 14px; margin-left: 10px; }
.feedback { margin-top: 10px; font-weight: bold; color: #88b04b; }
.exercise-name { font-weight: bold; }
</style>
</head>
<body>
<h1>Full Body Tracker Pro</h1>

<div>
  <button onclick="changeDay('Lundi')">Lundi</button>
  <button onclick="changeDay('Mercredi')">Mercredi</button>
  <button onclick="changeDay('Vendredi')">Vendredi</button>
</div>

<div id="exerciseList"></div>
<div class="feedback" id="feedback"></div>

<h2>Historique</h2>
<ul id="historyList"></ul>

<audio id="dingSound" src="https://www.soundjay.com/buttons/sounds/button-3.mp3" preload="auto"></audio>

<script>
const exercisesPool = {
  'Push': ['Pompes', 'DÃ©veloppÃ© couchÃ©', 'Dips'],
  'Legs': ['Squats', 'Fentes', 'SoulevÃ© de terre jambes tendues'],
  'Core': ['Abdos', 'Gainage', 'Crunchs'],
  'Pull': ['Tractions', 'Rowing', 'Curl biceps']
};

let currentDay = 'Lundi';
let exercises = [];
let currentExIndex = 0;
let currentSet = 0;
let weeklyHistory = JSON.parse(localStorage.getItem('weeklyHistory')) || [];

const exerciseList = document.getElementById('exerciseList');
const historyList = document.getElementById('historyList');
const feedback = document.getElementById('feedback');
const dingSound = document.getElementById('dingSound');

function getRandomExercise(type) {
  const pool = exercisesPool[type];
  return pool[Math.floor(Math.random() * pool.length)];
}

function generateSession() {
  return [
    { name: getRandomExercise('Push'), sets: 3, reps: 12, rest: 80 },
    { name: getRandomExercise('Pull'), sets: 3, reps: 10, rest: 80 },
    { name: getRandomExercise('Legs'), sets: 3, reps: 15, rest: 80 },
    { name: getRandomExercise('Core'), sets: 2, reps: 20, rest: 80 }
  ];
}

function renderExercises() {
  exerciseList.innerHTML = '';
  exercises.forEach((ex, index) => {
    const div = document.createElement('div');
    div.className = 'exercise';
    
    const leftDiv = document.createElement('div');
    const doneSets = index < currentExIndex ? ex.sets : (index === currentExIndex ? currentSet : 0);
    leftDiv.innerHTML = `<span class="exercise-name">${ex.name}</span> - ${doneSets}/${ex.sets} sets (${ex.reps} reps)`;
    
    const progressContainer = document.createElement('div');
    progressContainer.className = 'progress-bar';
    const progress = document.createElement('div');
    progress.className = 'progress';
    progress.style.width = `${(doneSets / ex.sets) * 100}%`;
    progressContainer.appendChild(progress);
    leftDiv.appendChild(progressContainer);
    
    const timerDiv = document.createElement('div');
    timerDiv.className = 'timer-circle';
    timerDiv.id = 'timer' + index;
    timerDiv.textContent = 'â±';
    
    const button = document.createElement('button');
    button.textContent = 'TerminÃ©';
    button.onclick = () => markSetDone();
    
    div.appendChild(leftDiv);
    div.appendChild(timerDiv);
    div.appendChild(button);
    exerciseList.appendChild(div);
  });
  updateFeedback();
}

function markSetDone() {
  if(currentExIndex >= exercises.length) return;
  
  const ex = exercises[currentExIndex];
  weeklyHistory.push({day: currentDay, name: ex.name, reps: ex.reps});
  localStorage.setItem('weeklyHistory', JSON.stringify(weeklyHistory));

  currentSet += 1;
  if(currentSet >= ex.sets){
    currentExIndex += 1;
    currentSet = 0;
    updateFeedback();
  } else {
    startRestTimer(ex.rest);
  }
  renderExercises();
  renderHistory();
}

function startRestTimer(seconds){
  let timeLeft = seconds;
  const timerDiv = document.getElementById('timer' + currentExIndex);
  timerDiv.style.backgroundColor = '#f0a500';
  timerDiv.textContent = timeLeft;
  const interval = setInterval(()=>{
    timeLeft -= 1;
    timerDiv.textContent = timeLeft;
    if(timeLeft <= 0){
      clearInterval(interval);
      timerDiv.style.backgroundColor = '#88b04b';
      timerDiv.textContent = 'âœ”';
      dingSound.play();
      updateFeedback();
    }
  }, 1000);
}

function renderHistory() {
  historyList.innerHTML = '';
  weeklyHistory.forEach(entry => {
    const li = document.createElement('li');
    li.textContent = `${entry.day} - ${entry.name} (${entry.reps} reps)`;
    historyList.appendChild(li);
  });
}

function changeDay(day) {
  currentDay = day;
  exercises = generateSession();
  currentExIndex = 0;
  currentSet = 0;
  renderExercises();
}

function updateFeedback() {
  if(currentExIndex >= exercises.length){
    feedback.textContent = "SÃ©ance terminÃ©e ! Bravo ðŸ’ª";
  } else {
    feedback.textContent = `Prochain set : ${exercises[currentExIndex].name} (${currentSet+1}/${exercises[currentExIndex].sets}) - Repos ${exercises[currentExIndex].rest}s`;
  }
}

// Initialisation
exercises = generateSession();
renderExercises();
renderHistory();
</script>
</body>
</html>
